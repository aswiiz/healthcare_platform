{% extends "base.html" %}

{% block title %}Admin Dashboard - Healthcare Hub{% endblock %}

{% block content %}
<div class="hero">
    <h1>Administrator Panel</h1>
    <p>Manage patient records, search medical history, and oversee platform data.</p>
</div>

<div class="card" style="max-width: 1200px; margin-bottom: 2rem;">
    <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;">
        <div style="display: flex; gap: 1rem;">
            <a href="{{ url_for('admin_add_patient') }}" class="btn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" />
                    <circle cx="9" cy="7" r="4" />
                    <line x1="19" y1="8" x2="19" y2="14" />
                    <line x1="16" y1="11" x2="22" y2="11" />
                </svg>
                Add New Patient
            </a>
        </div>

        <form action="{{ url_for('admin_dashboard') }}" method="GET"
            style="display: flex; gap: 0.5rem; flex-grow: 1; max-width: 500px;">
            <input type="text" name="search" placeholder="Search Patients by name or ID..." value="{{ search_query }}"
                class="form-control" style="flex-grow: 1;">
            <button type="submit" class="btn">Search</button>
            {% if search_query %}
            <a href="{{ url_for('admin_dashboard') }}" class="btn btn-secondary">Clear</a>
            {% endif %}
        </form>
    </div>
</div>

<div class="table-container">
    <table aria-label="Patient Registry">
        <thead>
            <tr>
                <th scope="col">ID</th>
                <th scope="col">Patient Name</th>
                <th scope="col">Gender</th>
                <th scope="col">Contact</th>
                <th scope="col">Username</th>
                <th scope="col" style="text-align: right;">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for user in users %}
            <tr>
                <td><strong>#{{ user['id'] }}</strong></td>
                <td>{{ user['name'] }}</td>
                <td><span class="badge" style="background: #f1f5f9; color: var(--text-main);">{{ user['gender']
                        }}</span></td>
                <td>{{ user['phone'] }}</td>
                <td><code
                        style="background: #f1f5f9; padding: 2px 6px; border-radius: 4px;">{{ user['username'] }}</code>
                </td>
                <td style="text-align: right;">
                    <a href="{{ url_for('admin_user_view', user_id=user['id']) }}" class="btn btn-secondary"
                        style="padding: 0.4rem 1rem; font-size: 0.85rem;">
                        View Records
                    </a>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="6" style="text-align: center; padding: 3rem; color: var(--text-muted);">
                    No patients found matching your search.
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}